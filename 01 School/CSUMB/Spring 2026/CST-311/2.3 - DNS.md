---
ðŸ“• Courses:
  - "!!Intro to Computer Networks"
tags:
  - ComputerScience
  - ComputerScience/Networks
Date Created: 2026-02-16
---
```table-of-contents
```
---
# What is DNS?
- ***Domain Name System*** is the **phone book** of the Internet
	- Matching a domain name to a unique IP address, so we do not have to remember the IP addresses for all online information resources
- EX: csumb.edu -> `15.197.156.176`
![[Pasted image 20260216143837.png|400]]
## History
- Before DNS, all mappings were in `hosts.txt`
	- `/etc/hosts` on Linux
	- `C:\Windows\System32\drivers\etc\hosts` on Windows
- Centralized, manual system
	- Changes were submitted to SRI via email
	- Machines periodically FTP new copies of `hosts.txt`
	- Administrators could pick names at their discretion
	- Any name was allowed
		- `tbs_server_at_csumb_pwns_joo_lol_kthxbye`
## Towards DNS
- Eventually, the `hosts.txt` system fell apart
	- Not scalable
	- Hard to enforce uniqueness of names
		- e.g. MIT
			- Massachusetts Institute of Technology?
			- Melbourne Institute of Technology?
	- Many machines had inaccurate copies of `hosts.txt`
- Thus, DNS was born

# How Does DNS Work?
![[Pasted image 20260216144257.png|450]]
## HOSTS File
- `/etc/hosts` file
![[Pasted image 20260216144337.png|450]]
## DNS at a High-Level
- Distribute database
	- No centralization
- Simple client/server architecture
	- UDP port 53, some implementation also use TCP
- **Hierarchical** namespace
	- As opposed to original, flat namespace
	- e.g. .com -> google.com -> mail.google.com
### DNS: A Distributed, Hierarchical Database
![[Pasted image 20260216144552.png|450]]
### Why not Centralize DNS?
- Single point of failure
- Traffic volume
- Distant centralized database
- Maintenance
- **Doesn't Scale**
### Root DNS Servers
![[Pasted image 20260216144836.png|350]]
- Contacted by local name server that can not resolve name
- Root name server
	- Contacts authoritative name server if name mapping not known
	- Gets mapping
	- Returns mapping to local name server
![[Pasted image 20260216144807.png|550]]
### Top-Level Domain (TLD) Servers:
![[Pasted image 20260216144913.png|350]]
- Responsible for com, org, net, edu, aero, jobs, museums, and all top-level country domains, e.g.: uk, fr, ca, jp
	- Network Solutions maintains servers for .com TLD
	- Educase for .edu TLD
### Authoritative DNS Servers
![[Pasted image 20260216145052.png|350]]
- Organization's own DNS server(s), providing authoritative hostname to IP mappings for organization's named hosts
- Can be maintained by organization or service provider
- When a domain is registered, the domain owner specifies the authoritative DNS servers responsible for managing the domain's DNS records
## Local DNS Name Server
- Does not strictly belong to hierarchy
- Each ISP (residential ISP, company, university) has one
	- also called "default name server"
- When host makes DNS query, query is sent to its local DNS server
	- Has local cache of recent name-to-address translation pairs (but may be out of date)
	- Acts as proxy, forwards query into hierarchy
### Basic Domain Name Resolution
- Every host knows a local DNS server
	- Sends all queries to the local DNS server
- If the local DNS can answer the query, then you're done
	1. Local server is also the authoritative server for that name
	2. Local server has **cached** the record for that name
- Otherwise, go down the hierarchy and search for the authoritative name server
	- Every local DNS server knows the root servers
	- Use cache to skip steps if possible
		- e.g. skip the root and go directly to .edu if the root file is cached
![[Pasted image 20260218140421.png|450]]
### Recursive DNS Query
- Puts burden of name resolution on contacted name server
- Heavy load at upper levels of hierarchy?
![[Pasted image 20260218140527.png|350]]
### Iterated DNS Query
- Contact server replies with the name of the next authority in the hierarchy
- "I don't know this name, but this other server might"
- This is how DNS works today
![[Pasted image 20260218140620.png|350]]
### Authoritative vs Non-Authoritative Answers
- An authoritative answer comes from a nameserver that is considered **authoritative** for the domain which it's returning a record for (one of the nameservers in the list for the domain you did a lookup on)
- A non-authoritative answer comes from anywhere else (a nameserver not in the list for the domain you did a lookup on)

# DNS Resource Records
- DNS **queries** have two fields: *name* and *type*
- Resource record is the **response** to a query
	- Four fields: (name, value, type, TTL(time to live))
	- There may be multiple records returned for one query
- What do the name and value mean?
	- Depends on the **type** of query and response

# DNS Types
- Type = A / AAA
	- Name = domain name
	- Value = IP address
	- A is IPv4, AAAA is IPv6
- Type = NS (Name Server)
	- Name = partial domain
	- Value = name of *DNS Server* for this domain
	- "Go send your query to this other server"
	- Returns the domain of the authoritative server storing the domain, not the IP of the domain itself
![[Pasted image 20260218141059.png|300]]
## Examples with `nslookup`
- `nslookup -type = A csumb.edu`
	- Querying the IPv4 address of the domain name "csumb.edu"
- Response:
```
Name: csumb.edu
Address: 3.33.150.239
Name: csumb.edu
Address: 15.197.156.176
```
- `nslookup -type=NS csumb.edu`
	- Querying the domain name server that the domain name "csumb.edu" belongs to
- Response:
```
csumb.edu nameserver = ns1.csumb.edu.
csumb.edu nameserver = ns4.csumb.edu.
csumb.edu nameserver = dnssec1.cenic.org.
csumb.edu nameserver = dnssec2.cenic.org.
```

# DNS Types, Continued
- Type = MX (Mail Exchange)
	- Name = domain in email address
	- Value = canonical name of mail server
- Type = CNAME
	- Name = an alias name for some "canonical" (the real) name
	- www.ibm.com is really servereast.backup2.ibm.com
	- Value = canonical name
![[Pasted image 20260218141720.png|300]]
## Examples with `nslookup`
- `nslookup -type=MX csumb.edu`
	- Querying the mail server for "csumb.edu"
- Response:
```
csumb.edu mail exchanger = 1 aspmx.l.google.com
csumb.edu mail exchanger = 5 alt1.aspmx.l.google.com
csumb.edu mail exchanger = 5 alt2.aspmx.l.google.com
csumb.edu mail exchanger = 10 alt3.aspmx.l.google.com
csumb.edu mail exchanger = 10 alt4.aspmx.l.google.com
csumb.edu mail exchanger = 10 feedback-smtp.us-east-1.amazonses.com
```

# Aliasing and Load Balancing
- One machine can have many aliases
![[Pasted image 20260218142059.png|450]]
- One domain can map to multiple machines
![[Pasted image 20260218142126.png|350]]

# Reverse Lookups
- What about the IP->name mapping?
- Separate server hierarchy stores reverse mappings
	- Rooted at in-addr.arpa and ip6.arpa
- Additional DNS record type: PTR
	- Name = IP address
	- Value = domain name
- Not guaranteed to exist for all IPs
![[Pasted image 20260218142246.png||300]]

# DNS as Indirection Service
- DNS gives us very powerful capabilities
	- Not only easier for humans to reference machines!
- Changing the IPs of machines becomes trivial
	- e.g. you want to move your web server to a new host
	- Just change the DNS record!

# Threats to DNS
- DNS Tracking
	- The DNS servers get information about your DNS resolving queries
	- ISPs usually have all information about users + this web browsing log
- DNS Poisoning
	- Attackers can get in the middle of the DNS resolution process, and have you resolve to an entirely different IP address of the web server that they control
	- Phishing attacks
	- Some interesting attack can bypass two-factor authentications

# ISP's and DNS Collecting Data
- ISP's collect your traffic and sell it to advertisers
	- They can fingerprint your computers
- ISP's may redirect bad URL's
	- Typo can lead to a search page with advertisements

# Public DNS Server
- OpenDNS
	- 208.67.222.222
	- 208.67.220.220
- Cloudflare
	- 1.1.1.1
	- 1.1.1.2
- Google
	- 8.8.8.8
	- 8.8.4.4
- Not authoritative name servers
- Fast and available to anyone and doesn't require additional setup
- Implement additional security features
	- Cloudflare claims that they sell infrastructure as a service, and they do not sell user's info. Provide public DNS for mainly brand recognition
- Organizations often combine public and private DNS servers for their day-to-day operations
---
# References
1. 